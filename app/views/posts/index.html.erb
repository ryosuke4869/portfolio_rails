<div class="wrapper">
<%= flash[:notice] %>
  <h2>投稿一覧</h2>
  <div class="index">
  <%#ーーーーーーーーーーーーーーーーーーーーーーー ここからソート機能ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー %>
    <%= search_form_for @q do |f| %>
      <%= f.label :sort_by, 'Sort by:' %>
      <%= f.select :s, options_for_select(
        [
          ['投稿日 降順', 'created_at desc'],
          ['投稿日 昇順', 'created_at asc'],
          ['いいね数 降順 ', 'likes desc'],
          ['いいね数 昇順', 'likes asc'],
          ['ブックマーク数 降順', 'bookmarks desc'],
          ['ブックマーク数 昇順', 'bookmarks asc'],
        ]
      ), {}, class: 'form-control' %>
      <%= f.submit 'Sort', class: 'btn btn-primary' %>
    <% end %>

    <div class="gallery row">
      <% @posts.each do |post| %>
        <div class="col-md-4">
          <div class="card my-5" style="width: 30rem; height: 40rem;">
            <%= image_tag post.desk_images[0].variant( resize: "478x269!").processed if post.desk_images.attached? %>
            <div class="card-body post-info">
                <% if post.user.avatar.attached? %>
                  <%= image_tag post.user.avatar, class: "user-icon" %>
                <% else %>
                  <img class="user-icon" src="/assets/default_icon.jpeg">
                <% end %>
                <%= link_to post.user.name, post_path(post.id) %>
                <i class="fa fa-heart" aria-hidden="true"></i>
                <%= post.likes.count %>
                <i class="fa-regular fa-bookmark" aria-hidden="true"></i>
                <%= post.bookmarks.count %>
                <i class="fa-regular fa-comments" aria-hidden="true"></i>
                <%= post.comments.count %>
            </div>
                <%= post.created_at %>

            <div class="card-body item-info row">
              <% if post.post_items.present? %>
                <% post.post_items.each do |post_item| %>
                  <div class="item-list col-4">
                    <div class="card" style="width: 5rem; height: 5rem;">
                      <%= image_tag(post_item.item.image_url) %>
                    </div>
                  </div>
                <% end %>
              <% else %>
                <p>この投稿にはアイテムが登録されていません</p>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>



